@using BizLogic.Planning
@using REYMAN.ViewModels
@model EditACViewModel
@{
    Layout = "AdminLayout";
}


<CENTER>
    <div class="main">
        <h1>Editar Acción Constructiva</h1>
        <form method="post">
            <div class="form-group col-md-4 col-md-offset-3">
                <label>Nombre</label>
                <input asp-for="Nombre" class="form-control" required/>
                <span asp-validation-for="Nombre" class="text-danger"></span>
            </div>
            <div class="form-group col-md-4 col-md-offset-3">
                <label>Inmueble</label>
                <select asp-for="Inmueble" class="form-control" onchange="assign_objects();">
                    @foreach (var item in Model.Inmuebles)
                    {
                        <option value=@item.Direccion id=@item.InmuebleID>@item.Direccion</option>
                    }
                </select>
            </div>
            <div class="form-group col-md-4 col-md-offset-3">
                <label>Objeto de Obra</label>
                <select asp-for="ObjetoDeObra" class="form-control">
                @foreach (var item in Model.Inmuebles)
                {
                    @foreach (var obj in item.ObjetosDeObra)
                    {
                        <option value=@obj.Nombre id=@item.InmuebleID>@obj.Nombre</option>
                    }
                }
                </select>
                <span asp-validation-for="ObjetoDeObra" class="text-danger"></span>
                
            </div>
            <div class="form-group col-md-4 col-md-offset-3">
                <label>Especialidad</label>
                <select asp-for="Especialidad" class="form-control" >
                    @foreach (var item in Model.Especialidades)
                    {
                        <option value=@item.Tipo>@item.Tipo</option>
                    }
                </select>
                <span asp-validation-for="Especialidad" class="text-danger"></span>
            </div>
            <div class="form-group col-md-4 col-md-offset-3">
                <label>Unidad de medida</label>
                <select asp-for="UnidadDeMedida" class="form-control" >
                    @foreach (var item in Model.Unidades)
                    {
                        <option value=@item.Nombre>@item.Nombre</option>
                    }
                </select>
                <span asp-validation-for="UnidadDeMedida" class="text-danger"></span>
            </div>
            <div class="form-group col-md-4">
                <label>Cantidad</label>
                <input asp-for="Cantidad" class="form-control" onkeydown="return int_validate(event, this.value);" oninput="parse(this, '0');"/>
                <span asp-validation-for="Cantidad" class="text-danger"></span>
            </div>
            <div class="form-group col-md-4">
                <label>Precio en CUC</label>
                <input asp-for="CUC" class="form-control" onkeydown="return double_validate(event, this.value);" oninput="precision(this, 2);"/>
                <span asp-validation-for="CUC" class="text-danger"></span>
            </div>
            <div class="form-group col-md-4 col-md-offset-3">
                <label>Precio en CUP</label>
                <input asp-for="CUP" class="form-control" onkeydown="return double_validate(event, this.value);" oninput="precision(this, 2);"/>
                <span asp-validation-for="CUP" class="text-danger"></span>
            </div>
            <button class="button" name="Id" value=@Model.Id>Guardar</button>
        </form>
    </div>
</CENTER>

@section Scripts{ 
    <script>
        parse(document.getElementById('Cantidad'), '0');

        function assign_objects() {
            var sel = document.getElementById("ObjetoDeObra");
            var op = sel.options;
            var id = document.getElementById("Inmueble").selectedOptions[0].id;
            var first;
            for (var i = op.length - 1; i >= 0; i--) {
                if (op[i].id != id) {
                    op[i].hidden = "hidden";
                }
                else {
                    op[i].hidden = "";
                    first = i
                }
                op[i].selected = false;
            }
            op[first].selected = true;
        }
        assign_objects();        
    </script>
}